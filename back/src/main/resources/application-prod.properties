# ================================================================
# Configuración de Producción - Fly.io
# Sistema Completo de Gestión de Querellas
# ================================================================

spring.application.name=querillas

# ================================================================
# SERVIDOR
# ================================================================
server.port=8081
server.shutdown=graceful

# ================================================================
# BASE DE DATOS POSTGRESQL
# ================================================================
# La URL se toma de la variable de entorno DATABASE_URL
spring.datasource.url=${DATABASE_URL}
spring.datasource.driver-class-name=org.postgresql.Driver

# Pool de conexiones optimizado para Fly.io
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ================================================================
# JPA / HIBERNATE
# ================================================================
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.properties.hibernate.default_schema=public
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# ================================================================
# JACKSON (JSON)
# ================================================================
spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS=false
spring.jackson.time-zone=UTC

# ================================================================
# JWT SECURITY
# ================================================================
# El secret se toma de la variable de entorno JWT_SECRET
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration-minutes=120

# ================================================================
# CORS
# ================================================================
# Las origins se toman de la variable de entorno CORS_ALLOWED_ORIGINS
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://querellas-frontend.fly.dev}

# ================================================================
# SWAGGER / OPENAPI
# ================================================================
springdoc.swagger-ui.path=/swagger-ui
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.enabled=true

# ================================================================
# ACTUATOR (Health Checks y Métricas)
# ================================================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# ================================================================
# LOGGING
# ================================================================
logging.level.root=INFO
logging.level.com.neiva.querillas=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=WARN

# Formato de logs optimizado para Fly.io
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# ================================================================
# FILE UPLOAD
# ================================================================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ================================================================
# PROFILES
# ================================================================
# NOTA: NO cargar datos de prueba en producción
# Los usuarios de desarrollo solo se cargan en perfil 'dev'
